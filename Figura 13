% Limpa a tela, as variáveis e fecha gráficos anteriores
clc;
clear;
close all;

%% 1. Definição da Planta e do Controlador PID

% --- Ganhos FINAIS AJUSTADOS (usados para definir a dinâmica do controlador) ---
Kp_desejado = 450;
Ki_desejado = 1836;
Kd_desejado = 35;

% Planta original (parte dinâmica, sem o ganho)
G_planta = tf(1, [1, 5.1894, 31.64]);

% Controlador PID (parte dinâmica, sem o ganho K final)
% Gc(s) = (Kd*s^2 + Kp*s + Ki) / s
Gc_pid_norm = tf([Kd_desejado, Kp_desejado, Ki_desejado], [1, 0]);

% Função de Transferência de Malha Aberta a ser plotada
% O LGR analisa a dinâmica do sistema.
L = Gc_pid_norm * G_planta;

% Exibe a função de transferência para verificação
disp('Função de Malha Aberta para o LGR (PID Ajustado + Planta):');
disp(L);

%% 2. Geração do Gráfico do LGR

% Cria uma nova janela para o gráfico
figure;

% Plota o Lugar Geométrico das Raízes
rlocus(L);

%% 3. Melhorias no Gráfico

% Adiciona um título descritivo
title('LGR do Sistema Compensado com Controlador PID Ajustado');

% Adiciona labels aos eixos
xlabel('Eixo Real');
ylabel('Eixo Imaginário');

% Adiciona uma grade para facilitar a leitura
grid on;

% Adiciona a reta de amortecimento para zeta = 0.591 (Overshoot de 10%)
zeta_desejado = 0.591;
sgrid(zeta_desejado, []); 

% Adiciona uma legenda para explicar a reta de amortecimento
legend('Trajetórias do LGR', ['Linha de Amortecimento ζ = ', num2str(zeta_desejado)]);
